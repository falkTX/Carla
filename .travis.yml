language:
    - cpp

sudo: required
dist: trusty

matrix:
include:
    # linux with gcc default (4.8)
    - os: linux
      dist: trusty
      compiler: gcc
      addons:
        apt:
          sources:
            - kxstudio-debian/libs
            - kxstudio-debian/mingw
            - kxstudio-debian/toolchain
      env:
        - MATRIX_EVAL="TARGET=linux"

    # linux with macOS cross-compilation
    - os: linux
      dist: trusty
      compiler: gcc
      addons:
        apt:
          sources:
            - kxstudio-debian/toolchain
      env:
        - MATRIX_EVAL="TARGET=macos"

    # linux with win32 cross-compilation
    - os: linux
      dist: trusty
      compiler: gcc
      addons:
        apt:
          sources:
            - kxstudio-debian/mingw
      env:
        - MATRIX_EVAL="TARGET=win32"

    # linux with win64 cross-compilation
    - os: linux
      dist: trusty
      compiler: gcc
      addons:
        apt:
          sources:
            - kxstudio-debian/mingw
      env:
        - MATRIX_EVAL="TARGET=win64"

install:
    - eval "${MATRIX_EVAL}"
    - sh ${TRAVIS_BUILD_DIR}/.travis/install.sh

script:
    - eval "${MATRIX_EVAL}"
    - sh ${TRAVIS_BUILD_DIR}/.travis/script-${MATRIX_EVAL}.sh
